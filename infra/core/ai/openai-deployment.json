{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.39.26.7824",
      "templateHash": "960984866374646610"
    },
    "description": "Creates an Azure OpenAI model deployment."
  },
  "parameters": {
    "accountName": {
      "type": "string",
      "metadata": {
        "description": "Name of the Azure OpenAI account"
      }
    },
    "deploymentName": {
      "type": "string",
      "metadata": {
        "description": "Name of the model deployment"
      }
    },
    "modelFormat": {
      "type": "string",
      "defaultValue": "OpenAI",
      "metadata": {
        "description": "Model format (e.g., OpenAI)"
      }
    },
    "modelName": {
      "type": "string",
      "metadata": {
        "description": "Model name (e.g., gpt-4, gpt-35-turbo)"
      }
    },
    "modelVersion": {
      "type": "string",
      "metadata": {
        "description": "Model version"
      }
    },
    "skuName": {
      "type": "string",
      "defaultValue": "Standard",
      "metadata": {
        "description": "SKU name for the deployment"
      }
    },
    "skuCapacity": {
      "type": "int",
      "defaultValue": 30,
      "metadata": {
        "description": "SKU capacity (TPM in thousands)"
      }
    }
  },
  "resources": [
    {
      "type": "Microsoft.CognitiveServices/accounts/deployments",
      "apiVersion": "2023-05-01",
      "name": "[format('{0}/{1}', parameters('accountName'), parameters('deploymentName'))]",
      "sku": {
        "name": "[parameters('skuName')]",
        "capacity": "[parameters('skuCapacity')]"
      },
      "properties": {
        "model": {
          "format": "[parameters('modelFormat')]",
          "name": "[parameters('modelName')]",
          "version": "[parameters('modelVersion')]"
        }
      }
    }
  ],
  "outputs": {
    "name": {
      "type": "string",
      "metadata": {
        "description": "The name of the deployment"
      },
      "value": "[parameters('deploymentName')]"
    },
    "id": {
      "type": "string",
      "metadata": {
        "description": "The ID of the deployment"
      },
      "value": "[resourceId('Microsoft.CognitiveServices/accounts/deployments', parameters('accountName'), parameters('deploymentName'))]"
    }
  }
}